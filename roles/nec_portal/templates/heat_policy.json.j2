{
    "context_is_admin": "role:admin and (role:O__{{ policy.region_name }}__ServiceProvider or role:O__{{ policy.region_name }}__ServiceManager or role:O__{{ policy.region_name }}__ContractManager)",

    "neccs": "role:T__{{ policy.region_name }}__ProjectMember",
    "admin_or_neccs": "rule:context_is_admin or rule:neccs",
    "neccs_deny_stack_user": "rule:context_is_admin or (rule:neccs and rule:deny_stack_user)",

    "deny_stack_user": "not role:heat_stack_user",

    "cloudformation:ListStacks": "rule:neccs_deny_stack_user",
    "cloudformation:CreateStack": "rule:neccs_deny_stack_user",
    "cloudformation:PreviewStack": "rule:neccs_deny_stack_user",
    "cloudformation:DescribeStacks": "rule:neccs_deny_stack_user",
    "cloudformation:DeleteStack": "rule:neccs_deny_stack_user",
    "cloudformation:UpdateStack": "rule:neccs_deny_stack_user",
    "cloudformation:DescribeStackEvents": "rule:neccs_deny_stack_user",
    "cloudformation:ValidateTemplate": "rule:neccs_deny_stack_user",
    "cloudformation:GetTemplate": "rule:neccs_deny_stack_user",
    "cloudformation:EstimateTemplateCost": "rule:neccs_deny_stack_user",
    "cloudformation:DescribeStackResource": "rule:admin_or_neccs",
    "cloudformation:DescribeStackResources": "rule:neccs_deny_stack_user",
    "cloudformation:ListStackResources": "rule:neccs_deny_stack_user",
    "cloudformation:CheckStack": "!",
    "cloudformation:SuspendStack": "!",
    "cloudformation:ResumeStack": "!",

    "cloudwatch:DeleteAlarms": "rule:neccs_deny_stack_user",
    "cloudwatch:DescribeAlarmHistory": "rule:neccs_deny_stack_user",
    "cloudwatch:DescribeAlarms": "rule:neccs_deny_stack_user",
    "cloudwatch:DescribeAlarmsForMetric": "rule:neccs_deny_stack_user",
    "cloudwatch:DisableAlarmActions": "rule:neccs_deny_stack_user",
    "cloudwatch:EnableAlarmActions": "rule:neccs_deny_stack_user",
    "cloudwatch:GetMetricStatistics": "rule:neccs_deny_stack_user",
    "cloudwatch:ListMetrics": "rule:neccs_deny_stack_user",
    "cloudwatch:PutMetricAlarm": "rule:neccs_deny_stack_user",
    "cloudwatch:PutMetricData": "rule:admin_or_neccs",
    "cloudwatch:SetAlarmState": "rule:neccs_deny_stack_user",

    "actions:action": "rule:neccs_deny_stack_user",
    "build_info:build_info": "rule:neccs_deny_stack_user",
    "events:index": "rule:neccs_deny_stack_user",
    "events:show": "rule:neccs_deny_stack_user",
    "resource:index": "rule:neccs_deny_stack_user",
    "resource:metadata": "rule:admin_or_neccs",
    "resource:show": "rule:neccs_deny_stack_user",
    "stacks:abandon": "rule:neccs_deny_stack_user",
    "stacks:create": "rule:neccs_deny_stack_user",
    "stacks:delete": "rule:neccs_deny_stack_user",
    "stacks:detail": "rule:neccs_deny_stack_user",
    "stacks:generate_template": "rule:neccs_deny_stack_user",
    "stacks:index": "rule:neccs_deny_stack_user",
    "stacks:list_resource_types": "rule:neccs_deny_stack_user",
    "stacks:lookup": "rule:neccs_deny_stack_user",
    "stacks:resource_schema": "rule:neccs_deny_stack_user",
    "stacks:show": "rule:neccs_deny_stack_user",
    "stacks:template": "rule:neccs_deny_stack_user",
    "stacks:update": "rule:neccs_deny_stack_user",
    "stacks:validate_template": "rule:neccs_deny_stack_user"
}
